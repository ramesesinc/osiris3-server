<schema>

	<element name="afstockcontrol" tablename="afstockcontrol">
		<field name="objid" primary="true"/>	
		<field name="state" />
		<field name="af" />
		<field name="unit" />
		<field name="refid" required="true"/>
		<field name="reftype" required="true"/>
		<field name="refdate" required="true"/>
		<field name="startstub" type="integer" required="true"/>
		<field name="endstub" type="integer" required="true"/>
		<field name="currentstub" type="integer" required="true"/>
		<field name="startseries" type="integer" required="true"/>
		<field name="currentseries" type="integer" required="true"/>
		<field name="endseries" type="integer" required="true"/>
		<field name="prefix"/>
		<field name="suffix"/>
		<field name="qtyreceived" type="integer"/>
		<field name="qtycancelled" type="integer"/>
		<field name="qtyissued" type="integer"/>
		<field name="qtybalance" type="integer"/>
		<field name="currentindexno" type="integer"/>
	</element>
	
	<element name="detail" tablename="afstockcontrol_detail">
		<field name="objid" primary="true"/>
		<field name="controlid" required="true" />
		<field name="refid" required="true"/>
		<field name="reftype" required="true"/>
		<field name="refdate" required="true"/>
		<field name="indexno" required="true"/>
		<field name="startseries" type="integer"/>
		<field name="endseries" type="integer"/>
		<field name="dr" required="true"/>
		<field name="cr" required="true"/>
		<field name="runbal" required="true"/>
		<field name="postingrefid" />
		<field name="remarks" />
	</element>	
	
	<element name="cancelled" tablename="afstockcontrol_cancelled">  
		<field name="objid" primary="true"/>
		<field name="conrolid" required="true"/>
		<field name="startseries" required="true"/>
		<field name="endseries" required="true"/>
		<field name="issuedate"/>
		<field name="issuedby"/>
	</element>

	
	
	<!-- this structure is intended for validating only -->
	<element name="receipt">  
		<field name="refid" required="true"/>
		<field name="reftype" required="true" />
		<field name="refdate" required="true"/>
		<complex name="items" required="true" type="list" ref="receiptitem" min="1"/>
	</element>
	<element name="receiptitem">  
		<field name="af" required="true"/>
		<field name="startseries" required="true"/>
		<field name="endseries" required="true"/>
		<field name="startstub" required="true"/>
		<field name="endstub" required="true"/>
		<field name="qty" required="true"/>
		<field name="prefix" />
		<field name="suffix" />
		<field name="unit" required="true"/>
	</element>
	<element name="issue">  
		<field name="refid" required="true"/>
		<complex name="issueto" required="true" ref="user" type="object"/>
		<field name="reftype" required="true"/>
		<field name="refdate" required="true"/>
		<field name="remarks" required="true"/>
		<complex name="items" required="true" type="list" ref="issueitem" min="1"/>
	</element>
	<element name="user">
		<field name="objid" required="true"/>
		<field name="name" required="true"/>
		<field name="jobtitle" required="true"/>
	</element>
	
	<element name="issueitem">  
		<field name="controlid" required="true"/>
		<!-- the purpose of indexno is to check if stock control was updated. i.e. versioning -->
		<field name="indexno" required="true"/>
		<field name="af" required="true"/>
		<field name="startseries" required="true"/>
		<field name="endseries" required="true"/>
		<field name="startstub" required="true"/>
		<field name="endstub" required="true"/>
		<field name="qty" required="true"/>
	</element>
	<element name="cancel">  
		<field name="refid" required="true"/>
		<field name="reftype" required="true"/>
		<field name="refdate" required="true"/>
		<field name="controlid" required="true"/>
		<field name="startseries" required="true"/>
		<field name="endseries" required="true"/>
		<field name="qty" required="true"/>
		<field name="remarks" required="true"/>
	</element>
</schema>