import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;

class LargeCattleTransferInterceptor {

	@Service('SpecialCollectionTypeService')
	def svc
	
	@After(pattern="CashReceiptService.init", eval="#{result.formno=='52'}")
	public def initCashReceiptItems(def evt) { 
		println 'evt.result -> ' + evt.result 
		def cs = evt.result 
		def setting = svc.open(cs.collectiontype.objid)
		if (setting){
			cs.amount = setting.amount
			cs.items = []
			cs.items += [
				objid : 'CSI' + new java.rmi.server.UID(),
				item : setting.item, 
				amount : setting.amount,
			]
		}
		else {
			throw new Exception('Collection Type ' + cs.collectiontype.name + ' account is not set.' )
		}
	}

}
