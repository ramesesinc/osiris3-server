import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import com.rameses.services.extended.*;

class RISReportService  {

	@PersistenceContext("main")
	def em;

	
	@ProxyMethod
	public def getReportData( risid ) {
		def ris = em.sqlContext.createNamedQuery("ris:getRISInfo").setParameter('risid', risid).singleResult
		if( !ris) throw new Exception("Could not open ris with objid " +  risid);
		ris.item = []
		if('AF:PURCHASE'.equals(ris.txntype))
			ris.items = em.sqlContext.createNamedQuery("ris:getRISReceiptItem").setParameter('risid', risid).singleResult
		else 
			ris.items = em.sqlContext.createNamedQuery("ris:getRISAFIssueItem").setParameter('risid', risid).singleResult
		return ris;
	}
		
}
